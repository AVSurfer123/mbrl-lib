defaults:
  - agent: sac

model:
  _target_: mbrl.models.Ensemble
  ensemble_size: 7
  in_size: ???
  out_size: ???
  member_cfg: ${member_cfg}
  device: ${device}
  optim_lr: 0.0075 # TODO this should be moved out of the ensemble class

member_cfg:
  _target_: mbrl.models.GaussianMLP
  device: ${model.device}
  num_layers: 4
  in_size: ${model.in_size}
  out_size: ${model.out_size}
  hid_size: 200

env: "gym@InvertedPendulum-v2"
term_fn: "inverted_pendulum"

env_dataset_size: 1000
validation_ratio: 0.1
dynamics_model_batch_size: 256
initial_exploration_steps: 20
num_episodes: 100
freq_train_dyn_model: 250
num_epochs_train_dyn_model: 40
patience: 5
num_model_rollouts: 2
rollout_schedule: [1, 15, 1, 1]
rollout_batch_size: 32
sac_buffer_capacity: ???
sac_samples_action: true
num_sac_updates_per_step: 40

seed: 0

device: "cuda:0"

log_frequency_sac: 1
log_save_tb: false
log_frequency_model: 5

eval_freq: 1
num_eval_episodes: 1
save_video: false

experiment: test_exp

hydra:
    run:
        dir: ./exp/mbrl/${env}/${now:%Y.%m.%d}/${now:%H%M}_${experiment}